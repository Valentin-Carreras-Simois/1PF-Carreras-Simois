"use strict";(self.webpackChunkangular_material=self.webpackChunkangular_material||[]).push([[680],{5680:(se,_,s)=>{s.r(_),s.d(_,{UsersModule:()=>ne});var u=s(6814),y=s(6208),c=s(1896),i=s(6223),d=s(696),e=s(5879),f=s(2296),w=s(2032),U=s(9157),I=s(8013);function D(t,n){if(1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"controlErrorMessage"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r)," ")}}function F(t,n){if(1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"controlErrorMessage"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r)," ")}}function S(t,n){if(1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"controlErrorMessage"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r)," ")}}function Y(t,n){if(1&t&&(e.TgZ(0,"mat-error"),e._uU(1),e.ALo(2,"controlErrorMessage"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,r)," ")}}let T=(()=>{class t{constructor(r,o){this.dialogRef=r,this.data=o,this.nameControl=new i.NI(null,[i.kI.required,i.kI.minLength(3)]),this.surnameControl=new i.NI(null,[i.kI.required]),this.emailControl=new i.NI(null,[i.kI.required,t=>t instanceof i.NI&&"string"==typeof t.value&&t.value?.toLowerCase().includes("@hotmail")?{noHotmail:!0}:null]),this.passwordControl=new i.NI(null,[i.kI.required]),this.userForm=new i.cw({name:this.nameControl,surname:this.surnameControl,email:this.emailControl,password:this.passwordControl}),this.data&&(this.editingUser=this.data,this.nameControl.setValue(this.data.name),this.surnameControl.setValue(this.data.surname),this.emailControl.setValue(this.data.email),this.passwordControl.setValue(this.data.password))}onSubmit(){this.userForm.invalid?this.userForm.markAllAsTouched():this.dialogRef.close(this.userForm.value)}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(d.so),e.Y36(d.WI))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-user-form-dialog"]],decls:38,vars:14,consts:[[1,"border","border-light-subtle","form-container"],["mat-dialog-title",""],["mat-dialog-content",""],[1,"grid",3,"formGroup"],[1,"field","col-12"],["appearance","outline",1,"form-input"],["formControlName","name","matInput","","type","text","name","name"],[4,"ngFor","ngForOf"],["formControlName","surname","matInput","","type","text","name","surname"],["formControlName","email","matInput","","type","email","name","email"],["formControlName","password","matInput","","type","password","name","password"],["mat-dialog-actions","",1,"mb-3","mr-2","flex","justify-content-end"],["mat-raised-button","","color","primary","type","submit","mat-button","",1,"mr-3",3,"click"],["mat-raised-button","","color","primary","mat-button","","mat-dialog-close","",1,"mr-2"]],template:function(r,o){1&r&&(e.TgZ(0,"div",0)(1,"h1",1),e._uU(2),e.qZA(),e.TgZ(3,"div",2)(4,"form",3)(5,"div",4)(6,"mat-form-field",5)(7,"mat-label"),e._uU(8,"Nombre"),e.qZA(),e._UZ(9,"input",6),e.YNc(10,D,3,3,"mat-error",7),e.ALo(11,"keyvalue"),e.qZA()(),e.TgZ(12,"div",4)(13,"mat-form-field",5)(14,"mat-label"),e._uU(15,"Apellido"),e.qZA(),e._UZ(16,"input",8),e.YNc(17,F,3,3,"mat-error",7),e.ALo(18,"keyvalue"),e.qZA()(),e.TgZ(19,"div",4)(20,"mat-form-field",5)(21,"mat-label"),e._uU(22,"Email"),e.qZA(),e._UZ(23,"input",9),e.YNc(24,S,3,3,"mat-error",7),e.ALo(25,"keyvalue"),e.qZA()(),e.TgZ(26,"div",4)(27,"mat-form-field",5)(28,"mat-label"),e._uU(29,"Contrase\xf1a"),e.qZA(),e._UZ(30,"input",10),e.YNc(31,Y,3,3,"mat-error",7),e.ALo(32,"keyvalue"),e.qZA()()()(),e.TgZ(33,"div",11)(34,"button",12),e.NdJ("click",function(){return o.onSubmit()}),e._uU(35,"Guardar"),e.qZA(),e.TgZ(36,"button",13),e._uU(37,"Cancelar"),e.qZA()()()),2&r&&(e.xp6(2),e.hij("",o.editingUser?"Editando a "+o.editingUser.name+" "+o.editingUser.surname:"Creando usuario","\n"),e.xp6(2),e.Q6J("formGroup",o.userForm),e.xp6(6),e.Q6J("ngForOf",e.lcZ(11,6,o.nameControl.errors)),e.xp6(7),e.Q6J("ngForOf",e.lcZ(18,8,o.surnameControl.errors)),e.xp6(7),e.Q6J("ngForOf",e.lcZ(25,10,o.emailControl.errors)),e.xp6(7),e.Q6J("ngForOf",e.lcZ(32,12,o.passwordControl.errors)))},dependencies:[u.sg,d.ZT,d.uh,d.xY,d.H8,f.lW,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u,w.Nt,U.KE,U.hX,U.TO,u.Nd,I.D]}),t})();var g=s(7398),v=s(5619),L=s(1631),M=s(8180),b=s(9862);const h_baseApiUrl="http://localhost:8000";var C=s(5502);let A=(()=>{class t{constructor(r,o){this.notifier=r,this.httpClient=o,this._users$=new v.X([]),this.users$=this._users$.asObservable(),this._isLoading$=new v.X(!1),this.isLoading$=this._isLoading$.asObservable()}loadUsers(){this._isLoading$.next(!0),this.httpClient.get(h_baseApiUrl+"/users",{headers:new b.WM({token:"123456789"}),params:{page:1,limit:50}}).subscribe({next:r=>{this._users$.next(r)},error:()=>{this.notifier.showError("Error al cargar los usuarios. Vuelve a intentarlo mas tarde.")},complete:()=>{this._isLoading$.next(!1)}})}getUsers(){return this.users$}getUserById(r){return this.users$.pipe((0,g.U)(o=>o.find(a=>a.id===r)))}createUser(r){const o=function $(t){let r="";for(let o=0;o<t;o++){const a=Math.floor(62*Math.random());r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(a)}return r}(10);this.httpClient.post(h_baseApiUrl+"/users",{...r,token:o}).pipe((0,L.z)(a=>this._users$.pipe((0,M.q)(1),(0,g.U)(l=>[...l,a])))).subscribe({next:a=>{this._users$.next(a)}})}updateUserById(r,o){this.httpClient.put(h_baseApiUrl+"/users/"+r,o).subscribe({next:()=>this.loadUsers()})}deleteUserById(r){this.httpClient.delete(h_baseApiUrl+"users/"+r).pipe().subscribe({next:o=>this.loadUsers()})}}return t.\u0275fac=function(r){return new(r||t)(e.LFG(C.l),e.LFG(b.eN))},t.\u0275prov=e.Yz7({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Z=s(617),m=s(5313),q=s(5306),J=s(2975);function E(t,n){1&t&&(e.TgZ(0,"th",9)(1,"span",10),e._uU(2,"ID"),e.qZA()())}function O(t,n){if(1&t&&(e.TgZ(0,"td",11),e._uU(1),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",r.id," ")}}function k(t,n){1&t&&(e.TgZ(0,"th",9)(1,"span",10),e._uU(2,"Nombre y Apellido"),e.qZA()())}function Q(t,n){if(1&t&&(e.TgZ(0,"td",11),e._uU(1),e.ALo(2,"fullName"),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",e.xi3(2,1,r,"uppercase"),"")}}function R(t,n){1&t&&(e.TgZ(0,"th",9)(1,"span",10),e._uU(2,"Email"),e.qZA()())}function B(t,n){if(1&t&&(e.TgZ(0,"td",11),e._uU(1),e.qZA()),2&t){const r=n.$implicit;e.xp6(1),e.hij(" ",r.email," ")}}function j(t,n){1&t&&(e.TgZ(0,"th",9)(1,"span",10),e._uU(2,"Acciones"),e.qZA()())}function H(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"td",11)(1,"button",12)(2,"mat-icon"),e._uU(3,"visibility"),e.qZA()(),e.TgZ(4,"button",13),e.NdJ("click",function(){const l=e.CHM(r).$implicit,p=e.oxw();return e.KtG(p.editUser.emit(l))}),e.TgZ(5,"mat-icon"),e._uU(6,"edit"),e.qZA()(),e.TgZ(7,"button",14),e.NdJ("click",function(){const l=e.CHM(r).$implicit,p=e.oxw();return e.KtG(p.deleteUser.emit(l))}),e.TgZ(8,"mat-icon"),e._uU(9,"delete"),e.qZA()()()}if(2&t){const r=n.$implicit;e.xp6(1),e.Q6J("routerLink",r.id)}}function z(t,n){1&t&&e._UZ(0,"tr",15)}function G(t,n){1&t&&e._UZ(0,"tr",16)}let X=(()=>{class t{constructor(){this.displayedColumns=["id","fullName","email","actions"],this.dataSource=[],this.deleteUser=new e.vpe,this.editUser=new e.vpe}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-users-table"]],inputs:{dataSource:"dataSource"},outputs:{deleteUser:"deleteUser",editUser:"editUser"},decls:15,vars:3,consts:[["mat-table","",1,"border","border-light-subtle","mat-elevation-z8",3,"dataSource"],["matColumnDef","id"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","fullName"],["matColumnDef","email"],["matColumnDef","actions"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["mat-header-cell",""],["appResaltado",""],["mat-cell",""],["mat-icon-button","","color","primary",3,"routerLink"],["mat-icon-button","","color","primary",3,"click"],["mat-icon-button","","color","warn",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(r,o){1&r&&(e.TgZ(0,"table",0),e.ynx(1,1),e.YNc(2,E,3,0,"th",2),e.YNc(3,O,2,1,"td",3),e.BQk(),e.ynx(4,4),e.YNc(5,k,3,0,"th",2),e.YNc(6,Q,3,4,"td",3),e.BQk(),e.ynx(7,5),e.YNc(8,R,3,0,"th",2),e.YNc(9,B,2,1,"td",3),e.BQk(),e.ynx(10,6),e.YNc(11,j,3,0,"th",2),e.YNc(12,H,10,1,"td",3),e.BQk(),e.YNc(13,z,1,0,"tr",7),e.YNc(14,G,1,0,"tr",8),e.qZA()),2&r&&(e.Q6J("dataSource",o.dataSource),e.xp6(13),e.Q6J("matHeaderRowDef",o.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",o.displayedColumns))},dependencies:[f.RK,Z.Hw,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,q.L,c.rH,J.k]}),t})();function K(t,n){1&t&&(e.TgZ(0,"div"),e._uU(1,"Esta Cargando..."),e.qZA())}const P=function(){return[]};function V(t,n){if(1&t){const r=e.EpF();e.TgZ(0,"app-users-table",4),e.NdJ("deleteUser",function(a){e.CHM(r);const l=e.oxw();return e.KtG(l.onDeleteUser(a))})("editUser",function(a){e.CHM(r);const l=e.oxw();return e.KtG(l.onEditUser(a))}),e.ALo(1,"async"),e.qZA()}if(2&t){const r=e.oxw();e.Q6J("dataSource",e.lcZ(1,1,r.users)||e.DdM(3,P))}}let W=(()=>{class t{constructor(r,o,a){this.matDialog=r,this.userService=o,this.notifier=a,this.userService.loadUsers(),this.isLoading$=this.userService.isLoading$,this.users=this.userService.getUsers().pipe((0,g.U)(l=>l.map(p=>({...p,name:p.name.toUpperCase(),surname:p.surname.toUpperCase()}))))}onCreateUser(){this.matDialog.open(T).afterClosed().subscribe({next:o=>{o&&(this.notifier.showSuccess("Se cargo el usuario correctamente"),this.userService.createUser({name:o.name,surname:o.surname,email:o.email,password:o.password}))}})}onDeleteUser(r){confirm(`\xbfEsta seguro de querer eliminar a ${r.name}?`)&&(this.userService.deleteUserById(r.id),this.notifier.showSuccess("Usuario eliminado"))}onEditUser(r){this.matDialog.open(T,{data:r}).afterClosed().subscribe({next:o=>{o&&(this.userService.updateUserById(r.id,o),this.notifier.showInfo("Se actualizo la informacion correctamente"))}})}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(d.uw),e.Y36(A),e.Y36(C.l))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-users"]],decls:11,vars:4,consts:[[1,"mb-5"],["mat-raised-button","","color","primary","type","button",3,"click"],[4,"ngIf","ngIfElse"],["notLoadingTemplate",""],[3,"dataSource","deleteUser","editUser"]],template:function(r,o){if(1&r&&(e.TgZ(0,"h1"),e._uU(1,"Usuarios"),e.qZA(),e.TgZ(2,"div",0)(3,"button",1),e.NdJ("click",function(){return o.onCreateUser()}),e.TgZ(4,"mat-icon"),e._uU(5,"add"),e.qZA(),e._uU(6," Crear Usuario "),e.qZA()(),e.YNc(7,K,2,0,"div",2),e.ALo(8,"async"),e.YNc(9,V,2,4,"ng-template",null,3,e.W1O)),2&r){const a=e.MAs(10);e.xp6(7),e.Q6J("ngIf",e.lcZ(8,2,o.isLoading$))("ngIfElse",a)}},dependencies:[u.O5,f.lW,Z.Hw,X,u.Ov],styles:["form[_ngcontent-%COMP%]{padding:2rem;margin-left:2rem}form[_ngcontent-%COMP%]   .form-input[_ngcontent-%COMP%]{width:50rem}form[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-top:3rem;padding:2rem;font-size:2rem}"]}),t})();var x=s(5195);function ee(t,n){if(1&t&&(e.TgZ(0,"div")(1,"h2"),e._uU(2,"Detalles del usuario"),e.qZA(),e.TgZ(3,"p")(4,"strong"),e._uU(5,"Nombre:"),e.qZA(),e._uU(6),e.qZA(),e.TgZ(7,"p")(8,"strong"),e._uU(9,"Apellido:"),e.qZA(),e._uU(10),e.qZA()()),2&t){const r=e.oxw();e.xp6(6),e.hij(" ",r.user.name,""),e.xp6(4),e.hij(" ",r.user.surname,"")}}function te(t,n){1&t&&(e.TgZ(0,"div"),e._uU(1," Usuario no encontrado! "),e.qZA())}let re=(()=>{class t{constructor(r,o,a,l){this.activatedRoute=r,this.router=o,this.notification=a,this.userService=l}ngOnInit(){this.userId=+this.activatedRoute.snapshot.params.id,this.loadUser()}loadUser(){this.userId&&this.userService.getUserById(this.userId).subscribe({next:r=>{r?this.user=r:(this.notification.showError("Usuario no encontrado","Error"),this.router.navigate(["/dashboard/users"]))},error:r=>{console.error("Error al cargar el usuario: ",r)}})}}return t.\u0275fac=function(r){return new(r||t)(e.Y36(c.gz),e.Y36(c.F0),e.Y36(C.l),e.Y36(A))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-user-detail"]],decls:9,vars:2,consts:[["routerLink","..","mat-icon-button",""],[4,"ngIf"]],template:function(r,o){1&r&&(e.TgZ(0,"button",0)(1,"mat-icon"),e._uU(2,"arrow_back"),e.qZA()(),e.TgZ(3,"mat-card")(4,"mat-card-content"),e.YNc(5,ee,11,2,"div",1),e.qZA()(),e.TgZ(6,"mat-card")(7,"mat-card-content"),e.YNc(8,te,2,0,"div",1),e.qZA()()),2&r&&(e.xp6(5),e.Q6J("ngIf",o.user),e.xp6(3),e.Q6J("ngIf",!o.user))},dependencies:[u.O5,x.a8,x.dn,f.RK,Z.Hw,c.rH],encapsulation:2}),t})(),oe=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.ez,c.Bz.forChild([{path:"",component:W},{path:":id",component:re}]),c.Bz]}),t})(),ne=(()=>{class t{}return t.\u0275fac=function(r){return new(r||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[u.ez,y.m,c.Bz,oe]}),t})()}}]);